```{r}
## installing all necessary packages
install.packages("tidyverse")
library(tidyverse)
install.packages("dplyr")
library(dplyr)


## TASK 1, DOWNLOADING ALL THE DATA FROM AIRBNB ##

## download the Amsterdam listings data ##
download.file("http://data.insideairbnb.com/the-netherlands/north-holland/amsterdam/2023-09-03/visualisations/listings.csv", "amsterdam_listings.csv")
library(tidyverse)

prototype = TRUE
n_max = Inf
if (prototype==TRUE) n_max = n_max
amsterdam_listings <- read_csv('amsterdam_listings.csv', n_max = n_max)



## download the Brussels listings data ##

download.file("http://data.insideairbnb.com/belgium/bru/brussels/2023-06-24/visualisations/listings.csv", "brussels_listings.csv")
library(tidyverse)
brussels_listings <- read_csv('brussels_listings.csv', n_max = n_max)


## download the London listings data ##
download.file("http://data.insideairbnb.com/united-kingdom/england/london/2023-06-08/visualisations/listings.csv", "london_listings.csv")
library(tidyverse)
london_listings <- read_csv('london_listings.csv', n_max = n_max)


## download the Berlin listings data ##
download.file("http://data.insideairbnb.com/germany/be/berlin/2023-06-22/visualisations/listings.csv", "berlin_listings.csv")
library(tidyverse)
prototype = TRUE
n_max = Inf
if (prototype==TRUE) n_max = n_max
berlin_listings <- read_csv('berlin_listings.csv', n_max = n_max)


## download the Paris listings data ##
download.file("http://data.insideairbnb.com/france/ile-de-france/paris/2023-06-06/visualisations/listings.csv", "paris_listings.csv")
library(tidyverse)
paris_listings <- read_csv('paris_listings.csv', n_max = n_max)


## ALL THE DATA IS NOW LOADED, NOW SELECT THE TOP 100 AND BOTTOM 100 LISTINGS FROM EACH CITY ##
ams_privaterooms <- amsterdam_listings %>%
  filter(room_type == "Private room")

ber_privaterooms <- berlin_listings %>%
  filter(room_type == "Private room")

bru_privaterooms <- brussels_listings %>%
  filter(room_type == "Private room")

lon_privaterooms <- london_listings %>%
  filter(room_type == "Private room")

par_privaterooms <- paris_listings %>%
  filter(room_type == "Private room")

## ALL THE DATA IS NOW LOADED, NOW SELECT THE TOP 100 AND BOTTOM 100 LISTINGS FROM EACH CITY ##  edit it later
ams200 <- ams_privaterooms %>%
  arrange(price) %>%
  slice(c(1:100, (n() - 99):n()))
ams200_DV <- ams200 %>%
  mutate(is_expensive = ifelse(row_number() <= 100, 0, 1))

ber200 <- ber_privaterooms %>%
  arrange(price) %>%
  slice(c(1:100, (n() - 99):n()))
ber200_DV <- ber200 %>%
  mutate(is_expensive = ifelse(row_number() <= 100, 0, 1))

bru200 <- bru_privaterooms %>%
  arrange(price) %>%
  slice(c(1:100, (n() - 99):n()))
bru200_DV <- bru200 %>%
  mutate(is_expensive = ifelse(row_number() <= 100, 0, 1))

lon200 <- lon_privaterooms %>%
  arrange(price) %>%
  slice(c(1:100, (n() - 99):n()))
lon200_DV <- lon200 %>%
  mutate(is_expensive = ifelse(row_number() <= 100, 0, 1))

par200 <-par_privaterooms %>%
  arrange(price) %>%
  slice(c(1:100, (n() - 99):n()))
par200_DV <- par200 %>%
  mutate(is_expensive = ifelse(row_number() <= 100, 0, 1))

## NOW THAT WE HAVE ALL THE DATA ON THE 100 CHEAP AND EXPENSIVE PRIVATE ROOMS, MERGE THE DATA ##
allcities_privatrooms_topbottom <- bind_rows(ams200_DV, ber200_DV, bru200_DV, lon200_DV, par200_DV)
view(allcities_privatrooms_topbottom)


```

